<!DOCTYPE html>
<html lang="ja">
<head>
 <meta charset="UTF-8" />
 <meta name="viewport" content="width=device-width, initial-scale=1.0" />
 <title>阪神タイガースオーダー入力</title>
 <style>
   body {
     font-family: sans-serif;
     margin: 0;
     background-color: #f0f0f0;
   }

   .container {
     position: relative;
     max-width: 100%;
     width: 100%;
     margin: auto;
     background-color: #222;
   }

   .field-image {
     width: 100%;
     height: auto;
     display: block;
   }

   .position-label {
     position: absolute;
     background-color: rgba(255,255,255,0.8);
     padding: 2px 4px;
     border-radius: 4px;
     font-size: 14px;
     text-align: center;
     transform: translate(-50%, -50%);
     pointer-events: none;
   }

   .input-area {
     display: flex;
     flex-direction: row;
     justify-content: center;
     align-items: flex-start;
     padding: 20px;
     flex-wrap: wrap;
     gap: 40px;
   }

   .order, .pitchers {
     background-color: #fff;
     padding: 20px;
     border-radius: 12px;
     box-shadow: 0 0 10px rgba(0,0,0,0.2);
   }

   .order {
     flex: 1 1 300px;
   }

   .pitchers {
     flex: 1 1 200px;
   }

   h2 {
     margin-top: 0;
     font-size: 18px;
     border-bottom: 1px solid #ccc;
     padding-bottom: 5px;
   }

   .order-item, .pitcher-item {
     display: flex;
     gap: 10px;
     margin-bottom: 10px;
     align-items: center;
   }

   select {
     flex: 1;
     padding: 5px;
     font-size: 14px;
   }

   label {
     min-width: 50px;
     font-weight: bold;
     font-size: 14px;
   }
 </style>
</head>
<body>

<div class="container">
 <img src="stadium.jpg" alt="野球場" class="field-image" />

 <!-- 守備位置の上に選手名が反映される -->
 <div id="position-P" class="position-label" style="top: 66%; left: 50%;">P</div>
 <div id="position-C" class="position-label" style="top: 92%; left: 50%;">C</div>
 <div id="position-1B" class="position-label" style="top: 68%; left: 72%;">1B</div>
 <div id="position-2B" class="position-label" style="top: 60%; left: 61%;">2B</div>
 <div id="position-3B" class="position-label" style="top: 68%; left: 28%;">3B</div>
 <div id="position-SS" class="position-label" style="top: 60%; left: 39%;">SS</div>
 <div id="position-LF" class="position-label" style="top: 57%; left: 16%;">LF</div>
 <div id="position-CF" class="position-label" style="top: 53%; left: 50%;">CF</div>
 <div id="position-RF" class="position-label" style="top: 57%; left: 84%;">RF</div>
</div>

<div class="input-area">
  <!-- 打順 -->
  <div class="order">
    <h2>Batting Order</h2>
    <template id="batter-template">
      <div class="order-item">
        <label>#<span class="batting-order"></span></label>
        <select class="position-select">
          <option value="">守備</option>
          <option value="P">投手</option>
          <option value="C">捕手</option>
          <option value="1B">一塁</option>
          <option value="2B">二塁</option>
          <option value="3B">三塁</option>
          <option value="SS">遊撃</option>
          <option value="LF">左翼</option>
          <option value="CF">中堅</option>
          <option value="RF">右翼</option>
        </select>
        <select class="player-select">
          <option value="">選手名</option>
          <option>近本</option>
          <option>中野</option>
          <option>森下</option>
          <option>佐藤</option>
          <option>大山</option>
          <option>前川</option>
          <option>ヘルナンデス</option>
          <option>坂本</option>
          <option>梅野</option>
          <option>小幡</option>
          <option>木浪</option>
          <option>島田</option>
          <option>渡邉</option>
          <option>熊谷</option>
          <option>糸原</option>
          <option>植田</option>
          <option>高寺</option>
          <option>豊田</option>
          <option>中川</option>
          <option>榮枝</option>
          <option>豊田</option>
          <option>高寺</option>
          <option>楠本</option>
          <option>投手</option>
        </select>
      </div>
    </template>
    <div id="batter-section"></div>
  </div>

  <!-- 投手 -->
  <div class="pitchers">
    <h2>Pitcher</h2>
    <div class="pitcher-item">
      <label>先発</label>
      <select>
        <option value="">選手名</option>
        <option>村上</option>
        <option>才木</option>
        <option>大竹</option>
        <option>伊原</option>
        <option>デュプランティエ</option>
        <option>門別</option>
        <option>富田</option>
        <option>ビーズリー</option>
        <option></option>
      </select>
    </div>
    <div class="pitcher-item">
      <label>中継ぎ１</label>
      <select>
        <option value="">選手名</option>
        <option>桐敷</option>
        <option>石井</option>
        <option>及川</option>
        <option>湯浅</option>
        <option>島本</option>
        <option>漆原</option>
        <option>岡留</option>
        <option>岩貞</option>
        <option>工藤</option>
        <option>ネルソン</option>
        <option>ゲラ</option>
      </select>
    </div>
    <div class="pitcher-item">
      <label>中継ぎ２</label>
      <select>
        <option value="">選手名</option>
        <option>桐敷</option>
        <option>石井</option>
        <option>及川</option>
        <option>湯浅</option>
        <option>島本</option>
        <option>漆原</option>
        <option>岡留</option>
        <option>岩貞</option>
        <option>工藤</option>
        <option>ネルソン</option>
        <option>ゲラ</option>
      </select>
    </div>
    <div class="pitcher-item">
      <label>中継ぎ３</label>
      <select>
        <option value="">選手名</option>
        <option>桐敷</option>
        <option>石井</option>
        <option>及川</option>
        <option>湯浅</option>
        <option>島本</option>
        <option>漆原</option>
        <option>岡留</option>
        <option>岩貞</option>
        <option>工藤</option>
        <option>ネルソン</option>
        <option>ゲラ</option>
      </select>
    </div>
    <div class="pitcher-item">
      <label>中継ぎ４</label>
      <select>
        <option value="">選手名</option>
        <option>桐敷</option>
        <option>石井</option>
        <option>及川</option>
        <option>湯浅</option>
        <option>島本</option>
        <option>漆原</option>
        <option>岡留</option>
        <option>岩貞</option>
        <option>工藤</option>
        <option>ネルソン</option>
        <option>ゲラ</option>
      </select>
    </div>
    <div class="pitcher-item">
      <label>中継ぎ５</label>
      <select>
        <option value="">選手名</option>
        <option>桐敷</option>
        <option>石井</option>
        <option>及川</option>
        <option>湯浅</option>
        <option>島本</option>
        <option>漆原</option>
        <option>岡留</option>
        <option>岩貞</option>
        <option>工藤</option>
        <option>ネルソン</option>
        <option>ゲラ</option>
      </select>
    </div>
    <div class="pitcher-item">
      <label>抑え</label>
      <select>
        <option value="">選手名</option>
        <option>岩崎</option>
        <option>石井</option>
        <option>桐敷</option>
      </select>
    </div>
  </div>
</div>

<div style="width: 100%; text-align: center; margin: 20px 0;">
  <button onclick="saveData()">保存</button>
  <button onclick="loadData()">読み込み</button>
  <button onclick="resetData()">リセット</button>
</div>

<script>
 // 打順×守備位置エリアの描画
 const batterSection = document.getElementById("batter-section");
 const batterTemplate = document.getElementById("batter-template");

 for (let i = 1; i <= 9; i++) {
   const clone = batterTemplate.content.cloneNode(true);
   clone.querySelector(".batting-order").textContent = i;
   batterSection.appendChild(clone);
 }

 // 守備位置ごとに選手を反映
 document.querySelectorAll(".position-select").forEach((posSel, idx) => {
   const playerSel = document.querySelectorAll(".player-select")[idx];

   function updatePositionLabel() {
     const pos = posSel.value;
     const name = playerSel.value;
     if (pos && name) {
       const label = document.getElementById("position-" + pos);
       if (label) {
         label.textContent = name;
       }
     }
   }

   posSel.addEventListener("change", updatePositionLabel);
   playerSel.addEventListener("change", updatePositionLabel);
 });

 // 以下のコードは既存のコードの下に追加

 function saveData() {
   const batters = Array.from(document.querySelectorAll(".order-item")).map(item => {
     return {
       pos: item.querySelector(".position-select").value,
       name: item.querySelector(".player-select").value
     };
   });

   const pitchers = Array.from(document.querySelectorAll(".pitchers select")).map(sel => sel.value);

   const data = {
     batters,
     pitchers
   };

   localStorage.setItem("tigersOrderData", JSON.stringify(data));
   alert("保存しました！");
 }

 function loadData() {
   const data = JSON.parse(localStorage.getItem("tigersOrderData"));
   if (!data) {
     alert("保存されたデータが見つかりません。");
     return;
   }

   const orderItems = document.querySelectorAll(".order-item");
   data.batters.forEach((batter, idx) => {
     if (orderItems[idx]) {
       orderItems[idx].querySelector(".position-select").value = batter.pos;
       orderItems[idx].querySelector(".player-select").value = batter.name;

       // 守備位置ラベル更新
       if (batter.pos && batter.name) {
         const label = document.getElementById("position-" + batter.pos);
         if (label) label.textContent = batter.name;
       }
     }
   });

   const pitcherSelects = document.querySelectorAll(".pitchers select");
   data.pitchers.forEach((val, idx) => {
     if (pitcherSelects[idx]) pitcherSelects[idx].value = val;
   });

   alert("読み込みました！");
 }

 function resetData() {
   if (!confirm("すべての入力をリセットしますか？")) return;

   document.querySelectorAll(".position-select").forEach(sel => sel.value = "");
   document.querySelectorAll(".player-select").forEach(sel => sel.value = "");
   document.querySelectorAll(".pitchers select").forEach(sel => sel.value = "");

   // 守備位置ラベルを初期化
   document.querySelectorAll(".position-label").forEach(label => {
     label.textContent = label.id.replace("position-", "");
   });

   alert("リセットしました");
 }
 
</script>

</body>
</html>
